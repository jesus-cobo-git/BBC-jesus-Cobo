<link rel="stylesheet" href="./styles.css" />

<custom-search>
    <div class="flex p-10 shadow-md min-h-60px">
        <button class="menu-toggle transparent">‚â°</button>
        <span class="logo">
            <span class="logo-item">J</span>
            <span class="logo-item">S</span>
            <span class="logo-item">L</span>
        </span>
        <button class="dialog-search transparent">üîç</button>
    </div>
    <dialog>
        <button class="close-btn">üóô</button>
        <h1>Search</h1>
        <input type="search" id="site-search" name="q" />

        <template>
            <li>
                <div class="flex flex-col items-center card">
                    <img class="object-cover item-image" src="https://flowbite.com/docs/images/blog/image-4.jpg">
                    <div class="flex flex-col justify-between">
                        <h5 class="item-title">
                            <a href="article.html?id={id}">
                                {value}
                            </a>
                        </h5>
                        <p class="item-description">Here are the biggest enterprise technology acquisitions of 2021 so
                            far, in reverse chronological order.
                        </p>
                        <relative-time time="Wed Oct 16 2024 11:12:41 GMT+0200" />
                    </div>
                </div>
            </li>
        </template>

        <ul id="search-results">
        </ul>
    </dialog>

</custom-search>
<main class="article-main">
    <custom-article>
        <article class="block article-content">
            <h1 class="article-title">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod</h1>
            <relative-time time="1729250766363"></relative-time>
            <img src="https://placehold.co/768x400/EEE/31343C" alt="Imagen del Art√≠culo" class="article-image">
            <p class="article-text">
              Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
              tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
              quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
              consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
              cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
              proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
            </p>
        </article>
    </custom-article>
</main>


<script>
    class RelativeTime extends HTMLElement {
        constructor() {
            super();
        }
        connectedCallback() {
            this.render();
            setInterval(() => this.render(), 1000);
        }
        static get observedAttributes() {
            return ['time'];
        }

        attributeChangedCallback(name, oldValue, newValue) {
            this.render();

        }
        render() {
            const timeValue = this.getAttribute('time')
            const time = timeValue ? new Date(timeValue).getTime() : Date.now();
            const now = Date.now();

            const diff = now - time;
            const seconds = Math.floor(diff / 1000) || 1;
            const minutes = Math.floor(diff / (1000 * 60));
            const hours = Math.floor(diff / (1000 * 60 * 60));
            const days = Math.floor(hours / 24);
            const months = Math.floor(days / 30);
            const years = Math.floor(months / 12);

            let aux = '...';
            if (months >= 12) {
                aux = `Hace ${years} a√±o${years > 1 ? 's' : ''}`
            } else if (days > 30 && months >= 1) {
                aux = `Hace ${months} mes${months > 1 ? 'es' : ''}`
            } else if (days >= 1) {
                aux = `Hace ${days} d√≠a${days > 1 ? 's' : ''}`
            } else if (hours >= 1) {
                aux = `Hace ${hours} hora${hours > 1 ? 's' : ''}`
            } else if (minutes >= 1) {
                aux = `Hace ${minutes} minuto${minutes > 1 ? 's' : ''}`
            } else if (seconds >= 1) {
                aux = `Hace ${seconds} segundo${seconds > 1 ? 's' : ''}`
            }

            this.textContent = aux;
        }
    }
    customElements.define('relative-time', RelativeTime);
</script>
<!--Custu Search-->
<script>
    const articles = [
        {
            "id": 1,
            "image": "https://cdn.kqed.org/wp-content/uploads/sites/35/2024/10/GettyImages-1347890261-1020x680.jpg",
            "title": "Climate Activists Push for Carbon Tax With Measure GG, But Critics Warn it Could Backfire",
            "description": "Grassroots climate activists argue a tax on gas use in large buildings will help all of Berkeley kick fossil fuels. But many politicians, businesses, and nonprofits, even those that work on climate, don‚Äôt think Measure GG is the policy to get there.",
            "date": "2023-10-17T11:00:16Z",
            "category": "Climate"
        },
        {
            "id": 2,
            "image": "https://fortune.com/img-assets/wp-content/uploads/2024/10/GettyImages-2170862982_413c33-e1729160290535.jpg?resize=1200,600",
            "title": "Musk‚Äôs empire risks being targeted by EU for potential X fines",
            "description": "The EU may target Elon Musk‚Äôs broader business empire for X fines, potentially including revenue from SpaceX and Neuralink to increase penalties.",
            "date": "2024-09-17T10:32:45Z",
            "category": "Business"
        },
        {
            "id": 3,
            "image": "https://media.autoexpress.co.uk/image/private/s--X-WVjvBW--/f_auto,t_content-image-full-desktop@1/v1729160267/autoexpress/2024/10/Omode E5 first UK drive.jpg",
            "title": "Omoda E5 in Noble trim - pictures",
            "description": "Pictures of the electric Omode E5 SUV being driven on UK roads. Pictures taken by Auto Express senior photographer Pete Gibson",
            "date": "2024-10-15T10:30:56Z",
            "category": "Automobile"
        },
        {
            "id": 4,
            "image": "https://i.bstr.es/highmotor/2021/01/renault-5-concept_7-1220x697.jpeg",
            "title": "Renault, Alpine and Citro√´n help the 2024 Paris Motor Show return to form",
            "description": "Explore the most delectable debuts at the Paris Motor Show 2024 ‚Äì or Mondial de l'Auto ‚Äì including designs from France's big car makers and niche machines from around the world",
            "date": "2024-10-13T10:25:24Z",
            "category": "Automobile"
        },
        {
            "id": 5,
            "image": "https://www.computerworld.com/wp-content/uploads/2024/10/3567767-0-90640600-1729160617-IDG-Germany-Intel-September-News.jpg?quality=50&strip=all&w=1024",
            "title": "Chinese cybersecurity association urges review of Intel products",
            "description": "The Cybersecurity Association of China (CSAC) has urged a security review of Intel products sold in the country, claiming the US semiconductor firm poses ongoing threats to China‚Äôs national security and interests.",
            "date": "2024-10-01T10:22:56Z",
            "category": "Technology"
        },
        {
            "id": 6,
            "image": "https://static.euronews.com/articles/stories/04/28/68/18/1200x675_cmsv2_92dba13c-6157-5f13-946f-a13e4da2d9fd-4286818.jpg",
            "title": "Spain‚Äôs National Elections Enter Final Stretch with Unprecedented Turnout",
            "description": "As Spain approaches its national elections, voter turnout is at a historic high. Experts say this could signal a major shift in the political landscape.",
            "date": "2024-10-27T12:15:00Z",
            "category": "ES Election"
        },
        {
            "id": 7,
            "image": "https://www.triatlonnoticias.com/wp-content/uploads/2022/09/img_63273a60175b0.jpg",
            "title": "Spain Clinches Victory in European Basketball Championship",
            "description": "In a thrilling match against France, Spain‚Äôs national basketball team took home the European Championship, marking their fourth title win in a decade.",
            "date": "2024-10-25T18:30:00Z",
            "category": "Sports"
        },
        {
            "id": 8,
            "image": "https://example.com/business-innovation.jpg",
            "title": "Spanish Startup Unveils AI-Driven Solar Panels for a Greener Future",
            "description": "A Spanish tech startup has launched an innovative AI-powered solar panel, designed to increase efficiency by 30%. The product is set to revolutionize the renewable energy market.",
            "date": "2024-10-20T09:45:00Z",
            "category": "Innovation"
        },
        {
        "id": 9,
        "image": "https://static.euronews.com/articles/stories/07/74/26/44/1200x675_cmsv2_389322d5-f7ae-5820-9e66-198dc8d37a4c-7742644.jpg",
        "title": "Candidates Gear Up for Final Debates Ahead of Spain‚Äôs Elections",
        "description": "With less than a week to go, the leading candidates prepare for their last debates in a bid to sway undecided voters.",
        "date": "2024-10-28T15:10:00Z",
        "category": "ES Election"
    },
    {
        "id": 10,
        "image": "https://example.com/election-polling.jpg",
        "title": "New Polling Data Shows Shift in Voter Preferences Among Young Spaniards",
        "description": "Recent polls reveal that younger voters in Spain are favoring progressive candidates, indicating potential shifts in traditional voting patterns.",
        "date": "2024-10-24T13:25:00Z",
        "category": "ES Election"
    },
    {
        "id": 11,
        "image": "https://example.com/election.jpg",
        "title": "Spanish Diaspora Pushes for Voting Rights Reform",
        "description": "Spanish citizens abroad are calling for voting rights reforms to make it easier to participate in national elections from overseas.",
        "date": "2024-10-18T11:55:00Z",
        "category": "ES Election"
    },

    // Sports Category
    {
        "id": 12,
        "image": "https://example.com/soccer-victory.jpg",
        "title": "Spain's National Soccer Team Qualifies for the 2024 UEFA Championship",
        "description": "Spain's soccer team has secured its spot in the UEFA championship, boosting hopes for a successful campaign.",
        "date": "2024-10-23T19:00:00Z",
        "category": "Sports"
    },
    {
        "id": 13,
        "image": "https://example.com/tennis.jpg",
        "title": "Spanish Tennis Star Advances to Semi-Finals in Madrid Open",
        "description": "Spain‚Äôs top-ranked tennis player made an impressive comeback to advance to the semi-finals, thrilling local fans.",
        "date": "2024-10-21T15:20:00Z",
        "category": "Sports"
    },
    {
        "id": 14,
        "image": "https://example.com/cycling.jpg",
        "title": "Spain to Host World‚Äôs Largest Cycling Tour Event",
        "description": "Spain has been selected as the host country for next year‚Äôs global cycling tour, which will feature top cyclists from around the world.",
        "date": "2024-10-17T17:10:00Z",
        "category": "Sports"
    },

    // Business Category
    {
        "id": 15,
        "image": "https://example.com/tech-expansion.jpg",
        "title": "Spanish Tech Firms Drive Global Expansion with New Funding",
        "description": "A recent wave of investment is fueling the expansion of Spanish tech companies into new international markets.",
        "date": "2024-10-27T08:30:00Z",
        "category": "Business"
    },
    {
        "id": 16,
        "image": "https://example.com/economy-growth.jpg",
        "title": "Spain‚Äôs Economy Set for Record Growth in 2024, Experts Predict",
        "description": "Economic analysts are forecasting substantial growth for Spain in 2024, driven by surges in tourism and renewable energy investments.",
        "date": "2024-10-22T11:15:00Z",
        "category": "Business"
    },
    {
        "id": 17,
        "image": "https://example.com/energy-project.jpg",
        "title": "Spanish Energy Giant Announces New Renewable Projects",
        "description": "Spain's leading energy company has announced plans to launch a series of renewable projects, aiming to meet rising global demand.",
        "date": "2024-10-20T16:50:00Z",
        "category": "Business"
    },

    // Innovation Category
    {
        "id": 18,
        "image": "https://example.com/smart-city.jpg",
        "title": "Madrid‚Äôs New Smart City Initiative Set to Transform Urban Living",
        "description": "Madrid has launched a new smart city initiative, integrating AI and IoT technologies to enhance sustainability and city services.",
        "date": "2024-10-26T09:45:00Z",
        "category": "Innovation"
    },
    {
        "id": 19,
        "image": "https://example.com/robotics-lab.jpg",
        "title": "Spanish Robotics Lab Develops Medical AI to Aid Surgeries",
        "description": "Researchers in Barcelona have developed AI-assisted robotics to assist surgeons with precision tasks, potentially reducing surgery times.",
        "date": "2024-10-23T14:30:00Z",
        "category": "Innovation"
    },
    {
        "id": 20,
        "image": "https://example.com/eco-friendly.jpg",
        "title": "Eco-Friendly Innovations Flourish in Spain's Startup Scene",
        "description": "Spanish startups focusing on eco-friendly tech have seen an upsurge, launching products aimed at reducing environmental impact.",
        "date": "2024-10-19T12:10:00Z",
        "category": "Innovation"
    },

    // Culture Category
    {
        "id": 21,
        "image": "https://example.com/culture-festival.jpg",
        "title": "Barcelona‚Äôs Annual Culture Festival Attracts Record Crowds",
        "description": "This year's cultural festival in Barcelona has seen record attendance, with visitors enjoying live music, art, and food from around the world.",
        "date": "2024-10-25T20:00:00Z",
        "category": "Culture"
    },
    {
        "id": 22,
        "image": "https://example.com/art-exhibit.jpg",
        "title": "New Art Exhibit in Madrid Celebrates Spanish Surrealism",
        "description": "Madrid's latest exhibit features surrealist works from Spanish artists, attracting art lovers from all over Europe.",
        "date": "2024-10-22T11:30:00Z",
        "category": "Culture"
    },
    {
        "id": 23,
        "image": "https://example.com/traditional-music.jpg",
        "title": "Reviving Tradition: Flamenco Music and Dance Gain New Popularity",
        "description": "Flamenco is making a comeback across Spain, with new generations embracing the traditional music and dance.",
        "date": "2024-10-18T14:00:00Z",
        "category": "Culture"
    },

    // Arts Category
    {
        "id": 24,
        "image": "https://example.com/theater.jpg",
        "title": "Spain‚Äôs National Theater Announces Upcoming Season Highlights",
        "description": "The Spanish National Theater has released its schedule for the upcoming season, promising an array of classic and contemporary works.",
        "date": "2024-10-24T10:20:00Z",
        "category": "Arts"
    },
    {
        "id": 25,
        "image": "https://example.com/art-awards.jpg",
        "title": "Young Spanish Artist Wins Prestigious European Art Award",
        "description": "A young Spanish painter has won the prestigious European Art Award for her work focusing on climate change and social issues.",
        "date": "2024-10-20T12:05:00Z",
        "category": "Arts"
    },
    {
        "id": 26,
        "image": "https://example.com/sculpture.jpg",
        "title": "Modern Sculptures Take Center Stage in Bilbao‚Äôs Outdoor Exhibition",
        "description": "Bilbao has opened an outdoor sculpture exhibition featuring works from acclaimed artists, drawing art enthusiasts from across the globe.",
        "date": "2024-10-17T16:35:00Z",
        "category": "Arts"
    }
    ];

    class CustomSearch extends HTMLElement {
        constructor() {
            super();
            this.articles = articles;
        }

        connectedCallback() {
            const dialogBtn = this.querySelector('.dialog-search');
            const closeBtn = this.querySelector('.close-btn');
            const dialog = this.querySelector('dialog');

            dialogBtn.addEventListener('click', () => {
                dialog.showModal();
            });
            closeBtn.addEventListener('click', () => {
                dialog.close();
            });
            const siteSearch = this.querySelector('#site-search');
            siteSearch.addEventListener('input', (event) => this.search(event));

            this.renderResults('')
        }

        search(event) {
            event.preventDefault();
            const siteSearch = this.querySelector('#site-search');
            const term = siteSearch.value
            // console.log({term});
            this.renderResults(term)
        }

        renderResults(term = '') {
            // Implement your search logic here
            const searchResults = this.querySelector('#search-results');
            searchResults.innerHTML = '';
            const _articles = this.articles
                .filter(article => article.title.toLowerCase().includes(term.toLowerCase()))

            // mode 3 using <template>
            const template = this.querySelector('template').content;
            // loop
            _articles.map(article => {
                const li = template.querySelector('li').cloneNode(true);
                // item-image, item-title, item-description
                li.querySelector('.card .item-image').src = article.image;
                li.querySelector('.card .item-description').textContent = article.description;
                // replate relative-time time
                li.querySelector('relative-time').setAttribute('time', article.date)
                li.querySelector('.card .item-title a').textContent = article.title;

                const enlace = li.querySelector('.card .item-title a')
                const href = enlace.href
                enlace.href = href.replace('{id}', article.id)

                searchResults.appendChild(li);
            })
        }
    }
    customElements.define('custom-search', CustomSearch);
</script>

<!-- Article -->
<script>
    const getId = () => {
        const searchParams = new URLSearchParams(location.search.slice(1));
        return Number(searchParams.get('id'));
    }

    class CustomArticle extends HTMLElement {
        constructor() {
            super();
            this.articleId = getId();
        }
        connectedCallback() {
            this.render();
        }

        render() {
            const article = articles.find(article => article.id == this.articleId)

            // reemplazos de los contenidos del article
            const h1 = this.querySelector('h1');
            h1.textContent = article.title;
            //   descripci√≥n
            const description = this.querySelector('p');
            description.textContent = article.description;
            //   imagen
            const img = this.querySelector('img');
            img.src = article.image;
            // relative time
            const relativeTime = this.querySelector('relative-time');
            //  relativeTime.setAttribute('time',article.date); --forma m√°s nueva de hacer el relativeTime
            const newRelativeTime = `<relative-time time="${article.date}"/>`//forma m√°s simple pero antigua
            relativeTime.outerHTML = newRelativeTime;
        }
    }
    customElements.define('custom-article', CustomArticle);

</script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const slidingMenu = document.getElementById("sliding-menu");
    const menuToggleBtn = document.querySelector(".menu-toggle");
    const closeMenuBtn = document.querySelector(".close-menu");

    menuToggleBtn.addEventListener("click", () => {
      slidingMenu.classList.add("open");
    });

    closeMenuBtn.addEventListener("click", () => {
      slidingMenu.classList.remove("open");
    });
  });
</script>